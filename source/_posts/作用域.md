---
title: 作用域
categories: JavaScript
keywords: 作用域
tags:
  - JavaScript
abbrlink: 7a108a3c
date: 2020-11-05 09:47:41
---
## 作用域

> 作用域：变量起作用的区域，也就是说：变量定义后，可以在哪个范围内使用该变量。
<!--more-->
编程语言中，作用域规则分为两种：

+ 词法作用域
+ 块级作用域 --- js没有块级作用域

在js里只有函数可以形成作用域，所有，词法作用域又叫函数作用域。

因为函数能够形成作用域，所以，函数内部声明的变量函数外部无法访问。

函数作用域是在函数定义的时候作用域就确定下来了，和函数在哪调用无关。

```javascript
var num = 123;
function f1() {
  console.log(num);
}

function f2(){
  var num = 456;
  f1();
}
f2();  //打印123
```

### 作用域链

> 作用域链：只要是函数，就会形成一个作用域，如果这个函数被嵌套在其他函数中，那么外部函数也有自己的作用域，这个一直往上到全局环境，就形成了一个作用域链。

`变量的搜索原则`：

1. 从当前作用域开始查找是否声明了该变量，如果存在，那么就直接返回这个变量的值。
2. 如果不存在，就会往上一层作用域查询，如果存在，就返回。
3. 如果不存在，一直查询到全局作用域，如果存在，就返回。如果在全局中也没有找到该变量会报错

### 作用域链练习
```javascript
// 1 
var num = 10;
fn1();
function fn1() {
  console.log(num);  // undefined
  var num = 20;
  console.log(num);  // 20
}
console.log(num);    // 10


// 2 -- 改造上面的面试题
var num = 10;
fn1();
function fn1() {
  console.log(num);  // 10
  num = 20;
  console.log(num);  // 20
}
console.log(num);    // 20


// 3
var num = 123
function f1(num) {
    console.log(num) // 456
}

function f2() {
    var num = 456
    f1(num)
}
f2()


// 4
var num1 = 10;
var num2 = 20;
function fn(num1) {
  num1 = 100;
  num2 = 200;
  num3 = 300;
  console.log(num1); //100
  console.log(num2); //200
  console.log(num3); //300
  var num3;
}
fn();
console.log(num1); //10
console.log(num2); //200
console.log(num3); //err


// 5
var num = 1;
function fn(){
  var num = 100;
  num++;
  console.log(num);
}
fn(); //101
fn(); 101
console.log(num); 1


// 6.
var color = "red";
function outer() {
    var anotherColor = "blue";

    function inner() {
        var tmpColor = color;
        color = anotherColor;
        anotherColor = tmpColor;
        console.log(anotherColor);
    }

    inner();
}
outer(); //red
console.log(color);  //blue
```
