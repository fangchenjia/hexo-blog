---
title: 原型链
categories: JavaScript
keywords: prototype 原型链
tags:
  - JavaScript
abbrlink: bf8cf30
date: 2020-10-31 14:36:01
---
## 原型

### 原型基本概念

Javascript 规定，每一个函数都有一个 `prototype` 属性，指向另一个对象。
这个对象的所有属性和方法，都会被构造函数的实例继承。
<!--more-->

这也就意味着，我们可以把所有对象实例需要共享的属性和方法直接定义在 `prototype` 对象上。

```
function Person (name, age) {
  this.name = name
  this.age = age
}

console.log(Person.prototype)

Person.prototype.type = 'human'

Person.prototype.sayName = function () {
  console.log(this.name)
}

var p1 = new Person(...)
var p2 = new Person(...)

console.log(p1.sayName === p2.sayName) // => true
```

这时所有实例的 `type` 属性和 `sayName()` 方法，其实都是同一个内存地址

### 构造函数、实例、原型三者之间的关系

构造函数：构造函数就是一个函数，配合new可以新建对象。

实例：通过构造函数实例化出来的对象我们把它叫做构造函数的实例。一个构造函数可以有很多实例。

原型：每一个构造函数都有一个属性`prototype`，函数的prototype属性值就是原型。通过构造函数创建出来的实例能够直接使用原型上的属性和方法。

<img src="https://myblog-1303177382.cos.ap-chongqing.myqcloud.com/blogpostimg/%E5%8E%9F%E5%9E%8B%E9%93%BE/原型三角关系.jpg" alt="">


### `__proto__`

任意一个对象，都会有`__proto__`属性，这个属性指向了构造函数的prototype属性，也就是原型对象。

获取原型对象：

+ 通过`构造函数.prototype`可以获取
+ 通过`实例.__proto__`可以获取（隐式原型）
+ 它们指向了同一个对象`构造函数.prototype === 实例.__proto__`



**注意：`__proto__`是浏览器的一个隐藏（私有）属性，IE浏览器不支持，不要通过它来修改原型里的内容，如果要修改原型中的内容，使用构造函数.prototype去修改**

### constructor属性

默认情况下，原型对象中只包含了一个属性：constructor，constructor属性指向了当前的构造函数。

![sanjiao](https://myblog-1303177382.cos.ap-chongqing.myqcloud.com/blogpostimg/%E5%8E%9F%E5%9E%8B%E9%93%BE/sanjiao.png)

## 原型链

### 原型链概念

任何一个对象，都有原型对象，原型对象本身又是一个对象，所以原型对象也有自己的原型对象，这样一环扣一环就形成了一个链式结构，我们把这个链式结构称为：原型链。

绘制对象的原型链结构：

```javascript
//1. var p = new Person();
//2. var o = new Object();
//3. var arr = new Array();
//4. var date = new Date();
//5. Math
//6. 查看一个div的原型链结构
```

总结：Object.prototype是原型链的尽头，Object.prototype的原型是null。

![](https://myblog-1303177382.cos.ap-chongqing.myqcloud.com/blogpostimg/%E5%8E%9F%E5%9E%8B%E9%93%BE/proto.png)



### 属性查找原则

如果是获取操作

1. 会先在自身上查找，如果没有
2. 则根据`__proto__`对应的原型去找，如果没有
3. 一直找到`Object.prototyp`，如果没有，那就找不到了。

如果是修改操作：

只会修改对象自身的属性，如果自身没有这个属性，那么就会添加这个属性，并不会修改原型中的属性。

### Object常用属性hasOwnProperty

		
>语法： 对象.hasOwnProperty("属性名")
>
>作用： 判断属性是否是对象自身的属性，如果是，返回true

in 运算符

>语法： 属性 in 对象
>
>作用： 判断属性能够被对象访问到, 如果可以，返回true,不管这个属性是对象自身的还是属于原型链中，只要对象能访问到，返回true。

小结：
> in 和 hasOwnProperty 的区别：
> 
> in： 能不能访问到
> 
> hasOwnProperty： 是不是自己的	
 	
hasOwnProperty 的使用场景：

for...in 用来过滤出对象自身的属性